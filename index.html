<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Marketing Channel Tester</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <style>
      body {font:unset;}
    </style>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="./styles.css" rel="stylesheet"/>
  </head>
  <body class="bg-gray-50 text-gray-800">
    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
      <header class="mb-8 text-center">
        <h1 class="text-3xl font-bold text-gray-900">
          Marketing Channel Tester
        </h1>
        <p class="text-gray-600 mt-2">
          Select an example or enter a URL and Referrer to see which channel
          rule matches.
        </p>
      </header>

      <main class="bg-white p-6 rounded-lg shadow-md">
        <!-- Input Section -->
        <div class="space-y-4">
          <div>
            <label
              for="examples"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Load Example</label
            >
            <select
              id="examples"
              class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
            >
              <option value="">Select a test case...</option>
            </select>
          </div>

          <div>
            <label for="url"
              class="block text-sm font-medium text-gray-700 mb-1">
              Current URL</label>
            <input
              type="text"
              id="url"
              class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
              placeholder="https://www.originenergy.com.au/"
            />
          </div>
          <div>
            <label for="referrer"class="block text-sm font-medium text-gray-700 mb-1">Referrer</label>
            <input
              type="text"
              id="referrer"
              class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
              placeholder="https://www.google.com/"
            />
          </div>
          <div>
            <label
              for="page_views_session"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Page Views in Session</label
            >
            <input
              type="number"
              id="page_views_session"
              class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
              value="1"
              min="1"
            />
          </div>
          <div>
            <label
              for="user_agent"
              class="block text-sm font-medium text-gray-700 mb-1"
              >User Agent</label
            >
            <input
              type="text"
              id="user_agent"
              class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
              placeholder="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)"
            />
          </div>
          <div>
            <label
              for="digital_data"
              class="block text-sm font-medium text-gray-700 mb-1"
              ><pre>digitalData =</pre> </label
            >
            <textarea
              disabled="disabled"
              id="digital_data"
              class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
            >
			      </textarea>
          </div>
        </div>

        <!-- Action Button -->
        <div class="mt-6 text-center">
          <button
            id="testButton"
            class="bg-indigo-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out"
          >
            Run Test
          </button>
        </div>

        <!-- Results Section -->
        <div id="results" class="mt-8">
          <h2 class="text-xl font-semibold text-gray-900 mb-4">Results</h2>
          <div class="overflow-x-auto border border-gray-200 rounded-lg">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th
                    scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Rule Name
                  </th>
                  <th
                    scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Matched Channel
                  </th>
                  <th
                    scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Channel Detail
                  </th>
                </tr>
              </thead>
              <tbody
                id="results-body"
                class="bg-white divide-y divide-gray-200"
              >
                <!-- Results will be injected here -->
                <tr>
                  <td colspan="3" class="px-6 py-4 text-center text-gray-500">
                    Run a test to see the results.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <h2 class="headroom text-xl font-semibold text-gray-900 mb-4">Implementation Notes</h2>
		<p><a class="blue" href="./marketing_channel_configuration.pdf">Current configuration documentation</a></p>
		<h3 class="headroom text-xl font-semibold text-gray-900 mb-3">Recent data for comparison</h3>
<pre>
Marketing Channel Expiration = 30 Days
Direct, Internal, Referring Domains, Personalisation,
and Origin App will never override any other channel
All other channels will override

DATA - June 30, 2025 - July 29, 2025
Internal	        1,029,168     40.4%
Email	              404,941     15.9%
Origin App	          345,986     13.6%
Paid Search	          326,382     12.8%
Natural Search	      195,684      7.7%
Direct	              115,636      4.5%
Social Networks	       84,746      3.3%
Offline (Vanity url)   19,203      0.8%
Referring Domains	   12,237      0.2%
Display ClickThrough    7,094      0.1%
Third Party	            4,679      0.0%
SMS / Push	            1,312      0.0%
Magic Links	               98      0.0%
Personalisation	           23      0.0%
None	                    1      0.0%

RULES WITH ZERO VISITS
* Rule 10 Universal Links
* Rule 14 Display ViewThrough
* Rule 15 Display (View and Click)
</pre>
      <h2 class="headroom text-xl font-semibold text-gray-900 mb-4">Bulk Test</h2>
      <div>
          <label for="csv_upload" class="block text-sm font-medium text-gray-700 mb-1">Or Upload CSV file.</label>
          <input type="file" id="csv_upload" accept=".csv" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" />
      </div>
      <div>
        <button id="download_csv" class="bg-green-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 ease-in-out mt-2" style="display:none;">Download Results CSV</button>
      </div>
      <div>
        <button id="view_csv_results" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out mt-2" style="display:none;">View Results Table</button>
      </div>
      </div>
      </main>
    </div>

    <div id="csv-results-table" class="mt-6 overflow-x-auto" style="display:none;"></div>

    <!-- The main application script -->
    <script type="module" src="./main.js"></script>
  </body>
</html>
